<Window x:Class="LocalStreetViewApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:h="clr-namespace:HelixToolkit.Wpf;assembly=HelixToolkit.Wpf"
        Title="本地街景浏览器" Height="900" Width="1200"
        Background="Black" WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <!-- 定义罗盘的视觉样式，这个Grid不会直接显示在界面上，而是作为3D材质 -->
        <Grid x:Key="CompassDesign" Width="200" Height="200">
            <!-- 半透明黑色背景圆圈 -->
            <Ellipse Fill="#80000000" Stroke="White" StrokeThickness="2"/>

            <!-- 十字线 -->
            <Path Data="M100,20 L100,180 M20,100 L180,100" Stroke="#40FFFFFF" StrokeThickness="1"/>

            <!-- 箭头与文字 (假设上方对应Z轴正向/北方) -->
            <!-- 北 (红色箭头) -->
            <Polygon Points="100,25 90,45 110,45" Fill="Red"/>
            <TextBlock Text="" Foreground="Red" FontSize="24" FontWeight="Bold" 
                   HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,5,0,0"/>

            <!-- 南 -->
            <Polygon Points="100,175 90,155 110,155" Fill="White"/>
            <TextBlock Text="" Foreground="White" FontSize="24" FontWeight="Bold" 
                   HorizontalAlignment="Center" VerticalAlignment="Bottom" Margin="0,0,0,5"/>

            <!-- 东 -->
            <Polygon Points="175,100 155,90 155,110" Fill="White"/>
            <TextBlock Text="" Foreground="White" FontSize="24" FontWeight="Bold" 
                   HorizontalAlignment="Right" VerticalAlignment="Center" Margin="0,0,5,0"/>

            <!-- 西 -->
            <Polygon Points="25,100 45,90 45,110" Fill="White"/>
            <TextBlock Text="" Foreground="White" FontSize="24" FontWeight="Bold" 
                   HorizontalAlignment="Left" VerticalAlignment="Center" Margin="5,0,0,0"/>
        </Grid>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="300"/>
        </Grid.RowDefinitions>

        <!-- 主3D视口 -->
        <h:HelixViewport3D x:Name="helixViewport" Grid.Row="0"
                           ShowCoordinateSystem="False"
                           ShowFrameRate="False"
                           ZoomExtentsWhenLoaded="False"
                           Background="Black"/>

        <!-- 地图面板 -->
        <Border Grid.Row="1" BorderBrush="Gray" BorderThickness="1" Background="#FF1E1E1E">
            <Grid >
                <!-- 地图图像 -->
                <Image x:Name="MapImage" Stretch="Uniform" 
                             MouseDown="MapImage_MouseDown"
                        MouseMove="MapImage_MouseMove"
                         MouseRightButtonDown="MapImage_MouseRightButtonDown"
                        MouseRightButtonUp="MapImage_MouseRightButtonUp"
                       MouseWheel="MapImage_MouseWheel"/>

                <!-- 地图控制按钮 -->
                <StackPanel VerticalAlignment="Top" HorizontalAlignment="Right" Margin="10">
                    <Button Content="+" Click="ZoomIn_Click" Width="30" Height="30" Margin="2" 
                            Background="#CCFFFFFF" FontWeight="Bold"/>
                    <Button Content="-" Click="ZoomOut_Click" Width="30" Height="30" Margin="2"
                            Background="#CCFFFFFF" FontWeight="Bold"/>
                    <Button Content="复位" Click="ResetView_Click" Width="40" Height="25" Margin="2"
                            Background="#CCFFFFFF" FontSize="10"/>
                    <Button Content="加载SHP" Click="BtnLoadSHP_Click" Width="60" Height="25" Margin="2"
                            Background="#CCFFFFFF" FontSize="10"/>
                    <Button Content="加载路网" Click="BtnLoadLine_Click" Width="60" Height="25" Margin="2"
            Background="#CCFFFFFF" FontSize="10"/>
                    
                </StackPanel>

                <!-- 坐标信息 -->
                <TextBlock x:Name="MapCoordText" VerticalAlignment="Bottom" HorizontalAlignment="Left" 
                          Margin="10" Foreground="White" FontSize="11" Background="#66000000" Padding="5"/>
            </Grid>
        </Border>

        <!-- 底部控制栏 -->
        <DockPanel Grid.Row="1" VerticalAlignment="Bottom" Background="#AA000000" Height="40">
            <Button Content="上一张" Width="80" Margin="10,0" Click="BtnPrev_Click"/>
            <Button Content="下一张" Width="80" Margin="10,0" Click="BtnNext_Click"/>
            <TextBlock x:Name="txtInfo"
                       Foreground="White" FontSize="14"
                       VerticalAlignment="Center" Margin="10,0"/>
        </DockPanel>
    </Grid>
</Window>