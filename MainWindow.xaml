<Window x:Class="LocalStreetViewApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:h="clr-namespace:HelixToolkit.Wpf;assembly=HelixToolkit.Wpf"
        Title="本地街景浏览器" Height="900" Width="1200"
        Background="Black" WindowStartupLocation="CenterScreen">
    <Window.Resources>
        <!-- 定义罗盘的视觉样式，这个Grid不会直接显示在界面上，而是作为3D材质 -->
        <Grid x:Key="CompassDesign" Width="200" Height="200">
            <!-- 1. 背景：全透明，不需要白色底板，防止挡住路面 -->
            <Grid.Background>
                <SolidColorBrush Color="Transparent"/>
            </Grid.Background>

            <!-- 2. 半透明深色圆盘 (模拟地面遮罩) -->
            <Ellipse Fill="#99000000" Stroke="White" StrokeThickness="3" Margin="10"/>

            <!-- 3. 十字准星 (可选，增加科技感) -->
            <Path Data="M100,30 L100,170 M30,100 L170,100" Stroke="#60FFFFFF" StrokeThickness="2"/>

            <!-- 4. 方向箭头 -->
            <!-- 北 (红色箭头 - 指向 XAML 的上方) -->
            <Polygon Points="100,25 85,55 115,55" Fill="#FF4444" Stroke="White" StrokeThickness="1"/>

            <!-- 南 (白色箭头) -->
            <Polygon Points="100,175 85,145 115,145" Fill="#DDDDDD" Stroke="Gray" StrokeThickness="1"/>

            <!-- 东 (白色小三角) -->
            <Polygon Points="175,100 155,90 155,110" Fill="#DDDDDD" Opacity="0.8"/>

            <!-- 西 (白色小三角) -->
            <Polygon Points="25,100 45,90 45,110" Fill="#DDDDDD" Opacity="0.8"/>

            <!-- 中心点 -->
            <Ellipse Width="8" Height="8" Fill="White" HorizontalAlignment="Center" VerticalAlignment="Center"/>
        </Grid>
    </Window.Resources>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
            <RowDefinition Height="300"/>
        </Grid.RowDefinitions>

        <!-- 主3D视口 -->
        <h:HelixViewport3D x:Name="helixViewport" Grid.Row="0"
                           ShowCoordinateSystem="False"
                           ShowFrameRate="False"
                           ZoomExtentsWhenLoaded="False"
                           Background="Black"/>

        <!-- 地图面板 -->
        <Border Grid.Row="1" BorderBrush="Gray" BorderThickness="1" Background="#FF1E1E1E">
            <Grid >
                <!-- 地图图像 -->
                <Image x:Name="MapImage" Stretch="Fill" 
                             MouseDown="MapImage_MouseDown"
                        MouseMove="MapImage_MouseMove"
                         MouseRightButtonDown="MapImage_MouseRightButtonDown"
                        MouseRightButtonUp="MapImage_MouseRightButtonUp"
                       MouseWheel="MapImage_MouseWheel"/>

                <!-- 地图控制按钮 -->
                <StackPanel VerticalAlignment="Top" HorizontalAlignment="Right" Margin="10">
                    <Button Content="+" Click="ZoomIn_Click" Width="30" Height="30" Margin="2" 
                            Background="#CCFFFFFF" FontWeight="Bold"/>
                    <Button Content="-" Click="ZoomOut_Click" Width="30" Height="30" Margin="2"
                            Background="#CCFFFFFF" FontWeight="Bold"/>
                    <Button Content="复位" Click="ResetView_Click" Width="40" Height="25" Margin="2"
                            Background="#CCFFFFFF" FontSize="10"/>
                    <Button Content="加载图片" Click="BtnLoadImages_Click" Width="60" Height="25" Margin="2"
                            Background="#CCFFFFFF" FontSize="10"/>
                    <Button Content="加载SHP" Click="BtnLoadSHP_Click" Width="60" Height="25" Margin="2"
                            Background="#CCFFFFFF" FontSize="10"/>
                    <Button Content="加载路网" Click="BtnLoadLine_Click" Width="60" Height="25" Margin="2"
            Background="#CCFFFFFF" FontSize="10"/>
                    
                </StackPanel>

                <!-- 坐标信息 -->
                <TextBlock x:Name="MapCoordText" VerticalAlignment="Bottom" HorizontalAlignment="Left" 
                          Margin="10" Foreground="White" FontSize="11" Background="#66000000" Padding="5"/>
            </Grid>
        </Border>

        <!-- 底部控制栏 -->
        <DockPanel Grid.Row="1" VerticalAlignment="Bottom" Background="#AA000000" Height="40">
            <Button Content="上一张" Width="80" Margin="10,0" Click="BtnPrev_Click"/>
            <Button Content="下一张" Width="80" Margin="10,0" Click="BtnNext_Click"/>
            <TextBlock x:Name="txtInfo"
                       Foreground="White" FontSize="14"
                       VerticalAlignment="Center" Margin="10,0"/>
        </DockPanel>
    </Grid>
</Window>